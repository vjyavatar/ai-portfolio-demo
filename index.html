<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>AI Stock Analysis | Real-Time Investment Research & Market Data</title>
    <meta name="description" content="Get instant AI-powered stock analysis with real-time market data for ANY stock ticker. Professional investment research with valuation metrics, risk assessment, and recommendations.">
    <meta name="keywords" content="stock analysis, AI investment research, real-time stock data, investment intelligence, stock recommendations, valuation analysis, risk assessment, TSLA, AAPL, MSFT">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://ai-portfolio-demo.onrender.com">
    
    <!-- Open Graph -->
    <meta property="og:title" content="AI Stock Analysis Platform">
    <meta property="og:description" content="Real-time AI-powered stock analysis for any ticker">
    <meta property="og:type" content="website">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
            color: #1f2937;
        }
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            color: white;
            padding: 25px 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        .logo { font-size: 26px; font-weight: 900; }
        .hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e3a8a 50%, #7c3aed 100%);
            color: white;
            padding: 70px 20px;
            text-align: center;
        }
        .hero h1 { font-size: 52px; font-weight: 900; margin-bottom: 15px; }
        .data-badge {
            background: #10b981;
            padding: 14px 35px;
            border-radius: 50px;
            display: inline-block;
            margin: 20px 0;
            font-weight: 700;
        }
        .container { max-width: 1000px; margin: 40px auto; padding: 0 20px; }
        .input-card {
            background: white;
            padding: 45px;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.12);
            margin-bottom: 35px;
        }
        .input-group {
            display: grid;
            grid-template-columns: 1fr 1fr 150px;
            gap: 15px;
            margin-bottom: 15px;
        }
        input {
            padding: 16px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
        }
        input:focus {
            outline: none;
            border-color: #1e3a8a;
        }
        .helper {
            font-size: 13px;
            color: #6b7280;
            margin-top: 8px;
        }
        .btn {
            padding: 16px;
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
        }
        .btn:disabled { opacity: 0.6; }
        .status {
            margin-top: 15px;
            padding: 15px;
            border-radius: 12px;
            display: none;
            font-weight: 600;
        }
        .status.show { display: block; }
        .status.info { background: #dbeafe; color: #1e40af; }
        .status.success { background: #d1fae5; color: #065f46; }
        .status.error { background: #fee2e2; color: #991b1b; }
        
        .report {
            display: none;
            margin-top: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.12);
        }
        .report.show { display: block; }
        .report-header {
            background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            color: white;
            padding: 40px;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }
        .report-header h2 { font-size: 32px; margin-bottom: 10px; }
        .ticker-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            margin-bottom: 10px;
            display: inline-block;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f9fafb;
        }
        .metric {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #1e3a8a;
        }
        .metric-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
        }
        .metric-value {
            font-size: 28px;
            font-weight: 900;
            color: #1e3a8a;
            margin: 8px 0;
        }
        .metric-change {
            font-size: 14px;
            font-weight: 600;
        }
        .positive { color: #10b981; }
        .negative { color: #ef4444; }
        
        .charts {
            padding: 30px;
        }
        .chart-box {
            background: #f9fafb;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .chart-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 20px;
        }
        
        .analysis {
            padding: 30px;
            background: white;
        }
        .analysis h3 {
            font-size: 22px;
            font-weight: 700;
            color: #1e3a8a;
            margin-bottom: 20px;
        }
        .analysis-text {
            background: #f9fafb;
            padding: 25px;
            border-radius: 12px;
            line-height: 1.8;
            white-space: pre-wrap;
        }
        
        @media (max-width: 768px) {
            .input-group { grid-template-columns: 1fr; }
            .hero h1 { font-size: 32px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="logo">‚ö° SENTINEL AI RESEARCH</div>
    </header>
    
    <div class="hero">
        <h1>AI Investment Intelligence</h1>
        <div class="data-badge">üî¥ REAL-TIME MARKET DATA</div>
        <p style="font-size: 18px; max-width: 700px; margin: 15px auto;">
            Professional stock analysis with live market data for any ticker
        </p>
    </div>
    
    <div class="container">
        <div class="input-card">
            <h2 style="margin-bottom: 25px; color: #1e3a8a;">Generate Analysis Report</h2>
            <div class="input-group">
                <input type="email" id="email" placeholder="your@email.com">
                <input type="text" id="ticker" placeholder="Enter ANY stock ticker (TSLA, MU, KAYNES.NS...)">
                <button class="btn" id="analyzeBtn" onclick="analyze()">Analyze</button>
            </div>
            <div class="helper">
                üí° Works with ANY stock ticker: TSLA, AAPL, MSFT, MU, NVDA, HDFCBANK.NS, KAYNES.NS, RELIANCE.NS, etc.
            </div>
            <div class="status" id="status"></div>
        </div>
        
        <div class="report" id="report">
            <div class="report-header">
                <div class="ticker-badge" id="tickerBadge"></div>
                <h2 id="companyName"></h2>
                <div style="font-size: 14px; margin-top: 10px;" id="timestamp"></div>
            </div>
            
            <div class="metrics" id="metrics"></div>
            
            <div class="charts">
                <div class="chart-box">
                    <div class="chart-title">üìä Valuation Metrics</div>
                    <canvas id="valChart" height="80"></canvas>
                </div>
                <div class="chart-box">
                    <div class="chart-title">üìà Price Trend</div>
                    <canvas id="trendChart" height="80"></canvas>
                </div>
            </div>
            
            <div class="analysis">
                <h3>üí° Investment Analysis</h3>
                <div class="analysis-text" id="analysisText"></div>
            </div>
        </div>
    </div>
    
    <script>
        let valChart, trendChart;
        
        function showStatus(msg, type) {
            const s = document.getElementById('status');
            s.textContent = msg;
            s.className = 'status show ' + type;
        }
        
        async function analyze() {
            const email = document.getElementById('email').value.trim();
            const ticker = document.getElementById('ticker').value.trim().toUpperCase();
            const btn = document.getElementById('analyzeBtn');
            const report = document.getElementById('report');
            
            if (!email || !ticker) {
                showStatus('Please fill in both fields', 'error');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = 'Analyzing...';
            report.classList.remove('show');
            
            showStatus('Analyzing ' + ticker + '... (30-60 seconds)', 'info');
            
            try {
                const res = await fetch('/api/generate-report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        company_name: ticker,
                        email: email
                    })
                });
                
                if (!res.ok) {
                    const err = await res.json().catch(() => ({}));
                    throw new Error(err.detail || 'Analysis failed');
                }
                
                const data = await res.json();
                console.log('Response:', data); // Debug
                
                if (!data.success) {
                    throw new Error('Analysis failed');
                }
                
                showStatus('‚úÖ Analysis complete!', 'success');
                displayReport(data);
                
                document.getElementById('email').value = '';
                document.getElementById('ticker').value = '';
                
            } catch (error) {
                console.error('Error:', error);
                showStatus('‚ùå ' + error.message, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Analyze';
            }
        }
        
        function displayReport(data) {
            const live = data.live_data;
            if (!live) {
                showStatus('‚ùå No market data received', 'error');
                return;
            }
            
            // Header
            document.getElementById('tickerBadge').textContent = live.ticker || 'N/A';
            document.getElementById('companyName').textContent = live.company_name || live.ticker || 'Company';
            document.getElementById('timestamp').textContent = 'üî¥ ' + (live.data_timestamp || '');
            
            // Metrics
            const curr = live.currency === 'INR' ? '‚Çπ' : '$';
            const metricsHTML = `
                <div class="metric">
                    <div class="metric-label">Price</div>
                    <div class="metric-value">${curr}${(live.current_price || 0).toLocaleString()}</div>
                    <div class="metric-change ${(live.price_change || 0) >= 0 ? 'positive' : 'negative'}">
                        ${(live.price_change || 0) >= 0 ? '‚ñ≤' : '‚ñº'} ${Math.abs(live.price_change || 0).toFixed(2)} (${(live.price_change_pct || 0).toFixed(2)}%)
                    </div>
                </div>
                <div class="metric">
                    <div class="metric-label">P/E Ratio</div>
                    <div class="metric-value">${live.pe_ratio || 'N/A'}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Market Cap</div>
                    <div class="metric-value">${formatCap(live.market_cap)}</div>
                </div>
                <div class="metric">
                    <div class="metric-label">52W Range</div>
                    <div class="metric-value" style="font-size: 18px;">${live.week52_low || 0} - ${live.week52_high || 0}</div>
                </div>
            `;
            document.getElementById('metrics').innerHTML = metricsHTML;
            
            // Charts
            createCharts(live);
            
            // Analysis
            document.getElementById('analysisText').textContent = data.report || 'Analysis not available';
            
            // Show
            document.getElementById('report').classList.add('show');
            setTimeout(() => {
                document.getElementById('report').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }
        
        function formatCap(cap) {
            if (!cap || cap === 0) return 'N/A';
            if (cap >= 1e12) return '$' + (cap / 1e12).toFixed(2) + 'T';
            if (cap >= 1e9) return '$' + (cap / 1e9).toFixed(2) + 'B';
            if (cap >= 1e6) return '$' + (cap / 1e6).toFixed(2) + 'M';
            return '$' + cap.toLocaleString();
        }
        
        function createCharts(live) {
            if (valChart) valChart.destroy();
            if (trendChart) trendChart.destroy();
            
            // Valuation
            const vCtx = document.getElementById('valChart').getContext('2d');
            valChart = new Chart(vCtx, {
                type: 'bar',
                data: {
                    labels: ['P/E', 'P/B', 'Div Yield'],
                    datasets: [{
                        data: [
                            parseFloat(live.pe_ratio) || 0,
                            parseFloat(live.pb_ratio) || 0,
                            parseFloat(live.dividend_yield) || 0
                        ],
                        backgroundColor: ['#1e3a8a', '#7c3aed', '#10b981']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });
            
            // Trend (mock data)
            const price = live.current_price || 100;
            const trend = [];
            for (let i = 6; i >= 0; i--) {
                const change = (Math.random() - 0.5) * 0.1;
                trend.push(price * (1 + change * i / 6));
            }
            
            const tCtx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(tCtx, {
                type: 'line',
                data: {
                    labels: ['6M', '5M', '4M', '3M', '2M', '1M', 'Now'],
                    datasets: [{
                        data: trend,
                        borderColor: '#1e3a8a',
                        backgroundColor: 'rgba(30, 58, 138, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        // Enter key
        document.getElementById('email').addEventListener('keypress', e => {
            if (e.key === 'Enter') document.getElementById('ticker').focus();
        });
        document.getElementById('ticker').addEventListener('keypress', e => {
            if (e.key === 'Enter') analyze();
        });
    </script>
</body>
</html>
